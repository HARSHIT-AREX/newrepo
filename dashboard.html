<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard â€” AyurSutra</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="dashboard-body">
  <!-- Theme toggle (top-right) -->
  <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">ðŸŒ™</button>

<script>
  // session guard
  const session = JSON.parse(localStorage.getItem('ayursutra_session') || 'null');
  if(!session) location.href='login.html';
</script>

<aside class="app-sidebar">
  <div class="sidebar-top">
    <div class="brand-xl"><span class="leaf">ðŸŒ¿</span> AyurSutra</div>
    <div class="user-info">Hi, <strong id="userName"></strong></div>
  </div>

  <nav class="sidebar-nav">
    <button class="nav-btn active" data-target="panelPatients">Patients</button>
    <button class="nav-btn" data-target="panelAppointments">Appointments</button>
    <button class="nav-btn" data-target="panelTherapies">Therapies</button>
    <button class="nav-btn" data-target="panelBilling">Billing</button>
    <button class="nav-btn" data-target="panelAnalytics">Analytics</button>
  </nav>

  <div class="sidebar-bottom">
    <button id="logoutBtn" class="btn btn-ghost">Logout</button>
  </div>
</aside>

<main class="app-main">
  <section class="stats-row">
    <div class="stat card stat-green"><div class="stat-title">Patients</div><div class="stat-value" id="countPatients">0</div></div>
    <div class="stat card stat-blue"><div class="stat-title">Appointments</div><div class="stat-value" id="countAppointments">0</div></div>
    <div class="stat card stat-purple"><div class="stat-title">Therapies</div><div class="stat-value" id="countTherapies">0</div></div>
    <div class="stat card stat-gold"><div class="stat-title">Revenue</div><div class="stat-value" id="countRevenue">â‚¹0</div></div>
  </section>

  <!-- Patients -->
  <section id="panelPatients" class="panel active">
    <div class="panel-head"><h3>Patients</h3></div>
    <form id="formPatient" class="form-inline">
      <input name="name" placeholder="Full name" required />
      <input name="age" type="number" placeholder="Age" required />
      <input name="contact" placeholder="Contact number" />
      <input name="file" type="file" accept="image/*,application/pdf" />
      <button class="btn btn-primary" type="submit">Add Patient</button>
      <button id="exportPatients" type="button" class="btn btn-outline">Export CSV</button>
    </form>
    <div class="table-wrap">
      <table class="data-table">
        <thead><tr><th>#</th><th>Name</th><th>Age</th><th>Contact</th><th>Files</th><th>Actions</th></tr></thead>
        <tbody id="tblPatients"></tbody>
      </table>
    </div>
  </section>

  <!-- Appointments -->
  <section id="panelAppointments" class="panel">
    <div class="panel-head"><h3>Appointments</h3></div>
    <form id="formAppt" class="form-inline">
      <select name="patientIdx" id="apptPatientSelect" required></select>
      <input name="date" type="date" required />
      <input name="time" type="time" required />
      <input name="doctor" placeholder="Doctor name" />
      <button class="btn btn-primary" type="submit">Book Appointment</button>
      <button id="exportAppts" type="button" class="btn btn-outline">Export CSV</button>
    </form>
    <div class="table-wrap">
      <table class="data-table">
        <thead><tr><th>#</th><th>Patient</th><th>Date</th><th>Time</th><th>Doctor</th><th>Actions</th></tr></thead>
        <tbody id="tblAppts"></tbody>
      </table>
    </div>
  </section>

  <!-- Therapies -->
  <section id="panelTherapies" class="panel">
    <div class="panel-head"><h3>Therapies</h3></div>
    <form id="formTher" class="form-inline">
      <select name="patientIdx" id="therPatientSelect" required></select>
      <input name="therapy" placeholder="Therapy type (e.g., Nasya)" required />
      <input name="sessions" type="number" placeholder="Sessions" />
      <button class="btn btn-primary" type="submit">Assign Therapy</button>
      <button id="exportTher" type="button" class="btn btn-outline">Export CSV</button>
    </form>
    <div class="table-wrap">
      <table class="data-table">
        <thead><tr><th>#</th><th>Patient</th><th>Therapy</th><th>Sessions</th><th>Actions</th></tr></thead>
        <tbody id="tblTher"></tbody>
      </table>
    </div>
  </section>

  <!-- Billing -->
  <section id="panelBilling" class="panel">
    <div class="panel-head"><h3>Billing</h3></div>
    <form id="formBill" class="form-inline">
      <select name="patientIdx" id="billPatientSelect" required></select>
      <input name="amount" type="number" placeholder="Amount (â‚¹)" required />
      <input name="desc" placeholder="Description" />
      <button class="btn btn-primary" type="submit">Create Invoice</button>
      <button id="exportInv" type="button" class="btn btn-outline">Export CSV</button>
    </form>
    <div class="table-wrap">
      <table class="data-table">
        <thead><tr><th>#</th><th>Patient</th><th>Amount</th><th>Description</th><th>Actions</th></tr></thead>
        <tbody id="tblBills"></tbody>
      </table>
    </div>
  </section>

  <!-- Analytics -->
  <section id="panelAnalytics" class="panel">
    <div class="panel-head"><h3>Analytics</h3></div>
    <div class="analytics-grid">
      <div class="chart-card">
        <canvas id="chartOverview"></canvas>
      </div>
      <div class="audit-card card">
        <h4>Activity Audit (mock)</h4>
        <div id="auditLog" class="audit-log"></div>
        <div style="margin-top:8px">
          <button id="clearAudit" class="btn btn-outline">Clear Log</button>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- Modal for editing -->
<div id="modal" class="modal hidden">
  <div class="modal-card">
    <h3 id="modalTitle">Edit</h3>
    <form id="modalForm" class="form-stack"></form>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button id="modalCancel" class="btn btn-outline" type="button">Cancel</button>
      <button id="modalSave" class="btn btn-primary" type="button">Save</button>
    </div>
  </div>
</div>

<script src="dashboard.js" defer></script>
</body>
</html>

